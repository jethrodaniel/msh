#!/usr/bin/env ruby

opts, files = ARGV.partition { |arg| arg.match? /\A-/ }
files.map! { |f| File.absolute_path(f) }
specs, tests = files.partition { |f| f.end_with? "_spec.rb" }

Dir.chdir File.dirname(__dir__) do
  puts Dir.pwd
  if specs.count.positive?
    exec "bundle", *%w[exec ruby -I lib:spec], *specs, "--documentation", *opts
  end
  if tests.count.positive?
    exec "bundle", *%w[exec ruby -I lib:spec], *tests
  end
end
